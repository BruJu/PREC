# PREC ontology

*This ontology is currently very tentative and is subject to*
*change.*


## Flags / Transformations

## http://bruy.at/prec#flagState

Predicate of triples that indicates if a featuere must be activated or not.


## http://bruy.at/prec#MetaProperty

Tells if the Property Graph contains meta properties or not.

If there are no meta properties, no intermediate node is created between a node / its property
and the associated value.


```ttl
PREFIX prec: <http://bruy.at/prec#>

# Keep a node between the property and its value (current default)
prec:MetaProperty prec:flagState true .

# Erase the node between the property and its value
prec:MetaProperty prec:flagState false .
```


### Result example

Property graph input: `create ({ name: 'Joe Biden' })` (Cypher format)

`+` is when set to true, `-` is when set to false

```diff
+   indiv:node/id/1 vocab/node/property/name indiv:literal/1.
+   indiv:literal/1 rdf:value "Joe Biden" .
-   indiv:node/id/1 vocab/node/property/name "Joe Biden" .

    indiv:node/id/1 a pgo:Node .
    vocab:node/property/name a prec:Property .
+   indiv:literal/1 a prec:PropertyValue .
```

## http://bruy.at/prec#KeepProvenance

By default, a triple is created for each node / relationship / property /
property value between its.

If this flag is set to false, the triples in the form `<http://www.example.org/indiv/node/id/1> a pgo:Node`
are deleted from the output graph.

```ttl
PREFIX prec: <http://bruy.at/prec#>

# Alternative 1
prec:KeepProvenance prec:flagState true .

# Alternative 2
prec:KeepProvenance prec:flagState false .
```



## Test infrastructure

Used in `./test/prec/*.ttl` files, which are names expected ouputs. These files
are inputs for `./z_prec.js`.

Expected outputs describes :
- where are the inputs by using `prec:testMetaData` as a subjet
- the expected triples generated by PREC. Blank nodes are used as wildcards.

### http://bruy.at/prec#testMetaData

Subject of triples that are inputs for `z_prec.js`. The triples with
`prec:testMetaData` as a subject won't be tested against the actual output.


### http://bruy.at/prec#pgPath

Relative path from the expected output file to the structure of the property
graph.

### http://bruy.at/prec#pgSource

An IRI that corresponds to the method to obtain the Property Graph structure.

Only https://neo4j.com/developer/neo4j-apoc/ is currently supported.
It corresponds for the output of the `apoc.export.json.all` function in Neo4J.

### http://bruy.at/prec#contextPath

Relative path from the expected output file to the used context.


## Relationships / Edge mapping

### http://bruy.at/prec#IRIOfRelationship

Predicate for relationship IRI mapping.

Subject must be the required IRI for a given relationship label.

Object is either :
- A literal, which corresponds to the label of the relationship.
- A Blank node, which describes constraints and further mappings for
the relation. The mapped blank nodes can then be described with the
following predicates :
    - http://bruy.at/prec#subject : Constraint on source and mapping of rdf:subject
    - http://bruy.at/prec#predicate : mapping of rdf:predicate
    - http://bruy.at/prec#object : Constant on predicate and mapping of rdf:object
    - http://bruy.at/prec#labelName : Constaint on the relationship label
    - http://bruy.at/prec#useRdfStar : Model used to convert the relationship to RDF.


### http://bruy.at/prec#modelAs

Specifies the model of representation of the relationship in RDF.

Common models may be :
- [prec:RDFReification](http://bruy.at/prec#RDFReification): model as a standard RDF Reification. It is the default.
- [prec:RDFStarUnique](http://bruy.at/prec#RdfStarUnique): model as a regular triple, using RDF-star for properties. This assumes that the edge label is used only one between two nodes.
- [prec:RDFStarOccurrence](http://bruy.at/prec#RDFStarOccurrence): model as an RDF-star occurence: a blank node represents the occurrence and [prec:occurenceOf](http://bruy.at/prec#occurrenceOf) is used to link the node to the triple it concerns.
- [prec:SingletonProperty](http://bruy.at/prec#SingletonProperty): model as a Singleton Property.

The source pattern is the following, where pvar is a prefix for variables:

```
pvar:self a pgo:Edge
pvar:self rdf:subject      pvar:source
pvar:self rdf:predicate    pvar:relationLabel
pvar:self rdf:object       pvar:destination
pvar:self pvar:propertyKey pvar:propertyValue
```

#### Built-in models

##### http://bruy.at/prec#RDFReification

Modelize the relationship as a standard RDF Reification.

```
pvar:self a pgo:Edge
pvar:self rdf:subject      pvar:source       
pvar:self rdf:predicate    pvar:relationLabel
pvar:self rdf:object       pvar:destination  
pvar:self pvar:propertyKey pvar:propertyValue
```

Note that this is the default behaviour.


##### http://bruy.at/prec#RdfStarUnique

Modelize the relationship as a triple that is added to the store.

```
pvar:source pvar:relationLabel pvar:destination
pvar:source pvar:relationLabel pvar:destination >> a pgo:Edge
pvar:source pvar:relationLabel pvar:destination >> pvar:propertyKey pvar:propertyValue
```

This modelization is valid only if two edges between the same nodes don't share
the same label.


##### http://bruy.at/RdfStarOccurrence

Modelize the relationship as occurrences.


##### http://bruy.at/SingletonProperty



#### From RDF Reification to hidden reification


##### http://bruy.at/prec#SubstitutionTerm


##### http://bruy.at/prec#substitutionTarget


##### http://bruy.at/prec#subject

If the relation is materialized with a standard RDF Reification, indicates the
IRI used in placed of the standard rdf:subject (/ rdf:predicate / rdf:object) IRI.

Renaming rdf:subject, rdf:predicate or rdf:object implies `prec:useRdfStar false`.

`prec:subject`, `prec:object` and `prec:predicate` renaming are inspired by
http://www.bobdc.com/blog/reification-is-a-red-herring/.

###### Example

*Property Graph*
```
[] -----> []
```

*Context*
```turtle
<https://example.org/aRelation> prec:IRIOfRelationship [
    prec:subject <https://example.org/subject> .
    prec:object  <https://example.org/object>  .
] .

# Always use RDF reification
prec:Relationships prec:useRdfStar false ;
prec:KeepProvenance prec:flagState false .
```

*Possible output:*
```
<https://example.org/relation/1> rdf:predicate <https://example.org/aRelation> ;
    <https://example.org/subject> <https://example.org/node/source> ;
    <https://example.org/object> <https://example.org/node/destination> ;
```



##### http://bruy.at/prec#predicate

Describes the relation with the relation label.

See prec#subject

The most common expected usage is to replace `rdf:predicate` with `rdf:type`
to materialize a Property Graph Relationship as a node.



##### http://bruy.at/prec#object

See prec#subject


### Constaints

#### http://bruy.at/prec#relationshipLabel

Only apply the transformation if the relation has the specified label.

See example of sourceLabel


#### http://bruy.at/prec#sourceLabel


Only apply the transformation if the source node has the specified label.

##### Example

*Property Graph:*
```
[ :Person ] --- :Like --> [ :Cat ] --- :Like --> [ :Food ] 
```

*Context:*
```turtle
<https://example.org/hates> prec:IRIOfRelationship [
    prec:relationshipLabel "Like" ;
    prec:sourceLabel       "Person"
] .

# Always use affirmed standard triples
prec:Relationships prec:useRdfStar prec:AsUnique ;
prec:KeepProvenance prec:flagState false .
ex:Person prec:IRIOfNodeLabel "Person" .
ex:Cat    prec:IRIOfNodeLabel "Cat"    .
ex:Food   prec:IRIOfNodeLabel "Food"   .
```

*Possible Output:*
```turtle
_:p <https://example.org/hates> _:c .
_:c :Like _:f .

_:p a ex:Person .
_:c a ex:Cat .
_:f a ex:Food .
```


*Explication:*
The first relation (between Person and Animal) satisfies the condition
as the relation label is like and the source node has the label Person.

The second relation (between Animal and Food) does not because the
source node does not have the label Person (only the label Cat).


#### http://bruy.at/prec#destinationLabel

Only apply the transformation if the destination node has the specified label.

See prec#sourceLabel





### http://bruy.at/prec#occurrenceOf

*This IRI is used in the generated graphs and should not be used in contexts as a "keyword".*

Specifies for which triple the relationship is an occurrenceOf.

Example:

> Steve Jobs worked for apple from 1976 to 1985 and from 1997 to 2011

```turtle

<< <stevejobs> <workingFor> <apple> >> prec::occurrenceOf _:first, _second.

_:first <from> 1976
_:first <to> 1985

_:second <from> 1997
_:second <to> 2011
```


# Unclassified

## http://bruy.at/prec#IRIOfProperty

Specifies that an IRI must be uses for the associated properties.


### Example

- Vocab: `<https://schema.org/familyName> prec:IRIOfProperty "name" .`
- \+ Cypher: `create (obama { name: 'Obama' })`
- = `_:obama <https://schema.org/familyName> "Obama".`



## http://bruy.at/prec#priority

Predicate of quads that indicates the priority of a rule. The higher, the more
the rule will take priority.

If unspecified the rules priority is:
- http://bruy.at/prec#IRIOfProperty : 0 + 1 per restriction on the node label
- http://bruy.at/prec#IRIOfRelationship : 0 + 1 per restriction on source or destination node

In case of priority ties, the smaller IRI in lexicographical order will be
applied at first.

## http://bruy.at/prec#alwaysAsserted

***OBSOLETE***

No effect

~~Type of labels of relationships that are always asserted.~~

- Vocab : `<https://cat> a prec:alwaysAsserted`




# http://bruy.at/prec#MetaData

Subject for meta data

# http://bruy.at/prec#CreatedVocabulary

Type of IRIs that has been created by PREC and that
should be mapped to an actual ontology.

It only applies to labels and property names.


# Extensions of PGO

## prec:Property


## prec:PropertyValue


# Reserved IRIs

IRIs in the prec namespace are reserved for the ontology (obviously) and
[its default implementation](https://github.com/BruJu/PREC/).

IRIs prefixed with `_` and `__` are reserved for implementation . 


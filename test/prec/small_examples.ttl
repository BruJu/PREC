@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>.
@prefix prec: <http://bruy.at/prec#> .
@prefix : <http://test/> .


prec:testMetaData prec:kind "SmallExamples" .


###############################################################################
# Relationship test

[] a prec:unitTest ;
   :usedCypherQuery
   '''
   create
       (alice:Person),
       (charlie:Person),
       (apple),
       (alice)-[:Knows]->(charlie),
       (alice)-[:Knows]->(apple)
   ''' ;
   prec:context :relationContext ;
   prec:output  :relationOutput ;
   prec:propertyGraph
   '''
        {"type":"node","id":"3","labels":["Person"]}
        {"type":"node","id":"4","labels":["Person"]}
        {"type":"node","id":"5"}
        {"id":"4","type":"relationship","label":"Knows","start":{"id":"3","labels":["Person"]},"end":{"id":"4","labels":["Person"]}}
        {"id":"5","type":"relationship","label":"Knows","start":{"id":"3","labels":["Person"]},"end":{"id":"5"}}
   '''
   .

:relationContext {
    prec:Relationships prec:useRdfStar prec:AsUnique .
    prec:KeepProvenance prec:flagState false .

    :Person prec:nodeLabelIRIOf "Person" .

    :knows prec:relationshipIRIOf [
        prec:relationshipLabel "Knows" ;
        prec:destinationLabel  "Person" 
    ] .

    :knowsAbout prec:relationshipIRIOf "Knows" .
}

:relationOutput {
    _:alice :knows _:charlie .
    _:alice a :Person . 
    _:charlie a :Person .
    _:alice :knowsAbout _:apple .
}


###############################################################################


[] a prec:unitTest ;
   prec:context :allPriority ;
   prec:output  :allPriorityResult ;
   prec:propertyGraph '{"type":"node","id":"5","labels":["Food", "Animal"],"properties":{"name":"Oeufs"}}' .


[] a prec:unitTest ;
   prec:context :animalPriority ;
   prec:output  :animalPriorityResult ;
   prec:propertyGraph '{"type":"node","id":"5","labels":["Food", "Animal"],"properties":{"name":"Oeufs"}}' .
   
[] a prec:unitTest ;
   prec:context :foodPriority ;
   prec:output  :foodPriorityResult ;
   prec:propertyGraph '{"type":"node","id":"5","labels":["Food", "Animal"],"properties":{"name":"Oeufs"}}' .
   
[] a prec:unitTest ;
   prec:context :defaultPriority ;
   prec:output  :animalPriorityResult ;
   prec:propertyGraph '{"type":"node","id":"5","labels":["Food", "Animal"],"properties":{"name":"Oeufs"}}' .


:allPriority {
    prec:MetaProperty   prec:flagState false .
    prec:KeepProvenance prec:flagState false .

    :Food prec:nodeLabelIRIOf "Food" .
    :Animal prec:nodeLabelIRIOf "Animal" .
    
    :food_name   prec:propertyIRIOf [ prec:propertyName "name" ; prec:nodeLabel "Food"   ; prec:priority 1 ] .
    :animal_name prec:propertyIRIOf [ prec:propertyName "name" ; prec:nodeLabel "Animal" ; prec:priority 2 ] .
    :all_name    prec:propertyIRIOf [ prec:propertyName "name" ;                           prec:priority 3 ] .
}

:animalPriority {
    prec:MetaProperty   prec:flagState false .
    prec:KeepProvenance prec:flagState false .

    :Food prec:nodeLabelIRIOf "Food" .
    :Animal prec:nodeLabelIRIOf "Animal" .
    
    :food_name   prec:propertyIRIOf [ prec:propertyName "name" ; prec:nodeLabel "Food"   ; prec:priority 2 ] .
    :animal_name prec:propertyIRIOf [ prec:propertyName "name" ; prec:nodeLabel "Animal" ; prec:priority 3 ] .
    :all_name    prec:propertyIRIOf [ prec:propertyName "name" ;                           prec:priority 1 ] .
}

:foodPriority {
    prec:MetaProperty   prec:flagState false .
    prec:KeepProvenance prec:flagState false .

    :Food prec:nodeLabelIRIOf "Food" .
    :Animal prec:nodeLabelIRIOf "Animal" .
    
    :food_name   prec:propertyIRIOf [ prec:propertyName "name" ; prec:nodeLabel "Food"   ; prec:priority 3 ] .
    :animal_name prec:propertyIRIOf [ prec:propertyName "name" ; prec:nodeLabel "Animal" ; prec:priority 2 ] .
    :all_name    prec:propertyIRIOf [ prec:propertyName "name" ;                           prec:priority 1 ] .
}

:defaultPriority {
    prec:MetaProperty   prec:flagState false .
    prec:KeepProvenance prec:flagState false .

    :Food prec:nodeLabelIRIOf "Food" .
    :Animal prec:nodeLabelIRIOf "Animal" .
    
    :food_name   prec:propertyIRIOf [ prec:propertyName "name" ; prec:nodeLabel "Food"   ] .
    :animal_name prec:propertyIRIOf [ prec:propertyName "name" ; prec:nodeLabel "Animal" ] .
    :all_name    prec:propertyIRIOf [ prec:propertyName "name" ;                         ] .
}

:allPriorityResult    { _:egg a :Food, :Animal ; :all_name    "Oeufs" . }
:animalPriorityResult { _:egg a :Food, :Animal ; :animal_name "Oeufs" . }
:foodPriorityResult   { _:egg a :Food, :Animal ; :food_name   "Oeufs" . }

